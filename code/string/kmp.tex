\subsubsection{kmp}
\begin{verbatim}
#include <cstdio>
#include <cstring>
#include <algorithm>
using namespace std;

const int N = 1000010;

int next[N];

int kmp(char *s, int n, char *t, int m) {
    int i, j;
    next[0] = -1;
    i = 0; j = -1;
    while (i < m) {
        if (j == -1 || t[i] == t[j]) {
            i++; j++;
            next[i] = (t[i] == t[j] ? next[j] : j);
        } else {
            j = next[j];
        }
    }
    i = j = 0;
    while (i < n && j < m) {
    if (j == -1 || s[i] == t[j]) {
        i++; j++;
    } else {
        j = next[j];
    }
}
return (j >= m ? i - m : -1);
}
\end{verbatim}
