\subsubsection{pell方程}
\begin{verbatim}
// x * x - D * y * y = 1, xn+yn*sqrt(d) = (x0+y0*sqrt(d))^n
// x * x - D * y * y = -1, xn+yn*sqrt(d) = (x0+y0*sqrt(d))^(2*n+1)
//
// a * x * x - b * y * y = c 
// get x0, y0 from x * x - a * b * y = 1
// get x1, y1 from a * x * x - b * y * y = c
// [xk] = [x0, by0] ^ k-1 * [x1]
// [yk] = [ay0, x0]            [y1]
//
bool pell( int D, int& x, int& y ) {  
    int sqrtD = sqrt(D + 0.0);  
    if( sqrtD * sqrtD == D ) return false;  
    int c = sqrtD, q = D - c * c, a = (c + sqrtD) / q;  
    int step = 0;  
    int X[] = { 1, sqrtD };  
    int Y[] = { 0, 1 };  
    while( true ) {  
        X[step] = a * X[step^1] + X[step];  
        Y[step] = a * Y[step^1] + Y[step];  
        c = a * q - c;  
        q = (D - c * c) / q;  
        a = (c + sqrtD) / q;  
        step ^= 1;  
        if( c == sqrtD && q == 1 && step ) {  
            x = X[0], y = Y[0];  
            return true;  
        }  
    }  
}
\end{verbatim}
